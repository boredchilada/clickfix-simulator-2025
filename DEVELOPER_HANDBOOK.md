# Developer Handbook: ClickFix Training Tool

Welcome to the developer documentation for the ClickFix Security Awareness Training Tool. This guide is intended for developers, security engineers, and contributors who want to understand, modify, or extend the codebase.

## 1. Project Overview

This tool is a lightweight, self-hosted Python application designed to simulate "ClickFix" (also known as ClearFake) social engineering attacks. It is used to train employees to recognize and resist clipboard injection techniques where users are tricked into pasting malicious PowerShell commands into the Windows Run dialog.

**Core Philosophy:**
-   **Simplicity:** No complex databases or build tools.
-   **Privacy:** No employee data upload required.
-   **Safety:** Payloads are harmless (MessageBox + Redirect).
-   **Stealth:** Uses generic routes (`/s/`) and realistic templates.
-   **Realism:** Mimics actual attack vectors (Clipboard -> Run Dialog -> PowerShell Stager).

## 2. Getting Started

### Prerequisites
-   Python 3.8+
-   `pip` (Python Package Manager)
-   Git
-   Docker (Optional, for containerized deployment)

### Installation

1.  **Clone the repository:**
    ```bash
    git clone https://github.com/boredchilada/clickfix-simulator-2025.git
    cd clickfix-simulator-2025
    ```

2.  **Create a Virtual Environment:**
    ```bash
    python -m venv venv
    # Windows
    venv\Scripts\activate
    # Linux/Mac
    source venv/bin/activate
    ```

3.  **Install Dependencies:**
    ```bash
    pip install -r requirements.txt
    ```

4.  **Initialize the Database:**
    ```bash
    flask --app run.py init-db
    ```

5.  **Configure Environment Variables:**
    Create a `.env` file (or set system env vars) for Admin Authentication:
    ```bash
    export ADMIN_USERNAME="admin"
    export ADMIN_PASSWORD="SuperSecretPassword123!"
    export SECRET_KEY="your-secret-key"
    export WEBHOOK_URL="https://discord.com/api/webhooks/..." # Optional
    ```

6.  **Generate SSL Certificates (Required for Clipboard API):**
    The Clipboard API requires a secure context (HTTPS) or localhost.
    ```bash
    # Development only
    mkdir certs
    openssl req -x509 -newkey rsa:4096 -nodes -keyout certs/key.pem -out certs/cert.pem -days 365 -subj "/CN=localhost"
    ```

### Running the Server

```bash
python run.py
```
The server will start on `https://localhost:443` (or the configured host/port).

### Docker Deployment

```bash
docker-compose up --build -d
```

## 3. Project Architecture

### File Tree

```
clickfix-training/
├── run.py                  # Application entry point
├── app/                    # Main application package
│   ├── __init__.py         # App factory (create_app) and configuration
│   ├── cli.py              # Custom CLI commands (init-db, create-test-data)
│   ├── extensions.py       # Flask extensions (SQLAlchemy db instance)
│   ├── models.py           # Database models (Campaign, Target, Event)
│   ├── utils.py            # Helper functions (auth, payload generation, logging)
│   └── blueprints/         # Route blueprints
│       ├── admin.py        # Admin dashboard routes (/admin/*)
│       ├── lure.py         # Phishing lure routes (/s/<slug>)
│       ├── main.py         # Core routes (/, /training)
│       └── stealth.py      # Stealth payload/tracking routes
├── app.py                  # Legacy monolith (deprecated, kept for reference)
├── cloner.py               # Script to clone websites and inject traps
├── config.py               # Configuration settings
├── instance/               # Contains the SQLite database (training_log.db)
├── static/                 # CSS, JS, Images
│   ├── css/
│   │   ├── styles.css      # Main stylesheet (includes UI component styles)
│   │   └── timeline.css    # Timeline chart styles
│   └── js/
│       ├── clickfix.js     # Core attack simulation logic
│       ├── timeline.js     # Dashboard timeline logic
│       ├── training.js     # Training page logic
│       └── ui.js           # UI utilities (Toast, Modal)
├── templates/              # HTML Templates (Jinja2)
│   ├── base_layout.html    # Master template with core ClickFix JS logic
│   ├── index.html          # Landing page / Dashboard
│   ├── admin/              # Admin interface templates
│   ├── campaigns/          # Cloned websites (generated by cloner.py)
│   ├── lures/              # Static lure templates (Teams, SharePoint, etc.)
│   ├── training/           # Educational "You Failed" page
│   └── traps/              # HTML fragments for the traps
│       ├── cloudflare.html     # Cloudflare CAPTCHA verification trap
│       ├── chrome_update.html  # Chrome security update trap
│       ├── windows_update.html   # Windows Update fullscreen trap
│       ├── filefix.html          # FileFix Explorer address bar trap
│       ├── missing_font.html     # Missing Font Pack trap
│       └── root_certificate.html # Root Certificate installation trap
├── Dockerfile              # Docker build instructions
├── entrypoint.sh           # Docker entrypoint script
├── requirements.txt        # Python dependencies
└── DEVELOPER_HANDBOOK.md   # This file
```

### Key Components

1.  **The Lure (`/s/<slug>`):**
    -   The entry point for the target.
    -   Served by `app/blueprints/lure.py`.
    -   Can be a static template (from `templates/lures/`) or a cloned campaign (from `templates/campaigns/`).
    -   **Stealth Slugs:** The system supports nested slugs (e.g., `/s/secure/login/v2`) to mimic real URLs.

2.  **The Trap:**
    -   The UI element that tricks the user (e.g., "Run Fix", "Verify Human").
    -   Contains the JavaScript to copy the payload to the clipboard.
    -   Located in `templates/traps/`.
    -   **Mechanism:** Uses `navigator.clipboard.writeText()` triggered by a user interaction (click).

3.  **The Payload:**
    -   A PowerShell script generated dynamically for each user.
    -   **Stage 1 (Clipboard):** A "stager" command that uses `curl` or `iwr` to download the full script. This bypasses character limits in the Run dialog.
    -   **Stage 2 (Server):** The full script served at `/payload/<uid>`. It performs a "Beacon" callback to the server and shows a training message.

4.  **Tracking:**
    -   **Page View:** Logged when the lure loads.
    -   **Button Click:** Logged via AJAX when the user clicks the trap button (indicates intent).
    -   **Execution:** Logged when the PowerShell script calls back to the server (indicates compromise).
    -   **Training:** Tracks the user's journey through the educational content (`TRAINING_VIEWED`, `TRAINING_COMPLETED`, `TRAINING_ACKNOWLEDGED`).

## 4. Code Documentation

### `app/` - The Application Package

The application logic is now modularized within the `app/` directory using the Flask Application Factory pattern.

#### `app/__init__.py` - Application Factory

Contains the `create_app(config_class=Config)` factory function which:
-   Initializes the Flask app with template and static folder paths
-   Loads configuration from `config.py`
-   Sets up logging to `app.log`
-   Initializes SQLAlchemy with WAL mode for better concurrency
-   Registers all blueprints (`main_bp`, `admin_bp`, `lure_bp`)
-   Registers stealth routes dynamically based on config
-   Registers CLI commands

#### `app/extensions.py` - Flask Extensions

Contains shared Flask extension instances:
-   `db`: SQLAlchemy database instance

#### `app/models.py` - Database Models

Defines the database schema using SQLAlchemy:

-   **`Campaign`**: Stores campaign metadata
    -   `id`: Primary key
    -   `name`: Campaign name
    -   `client_name`: Client identifier
    -   `scenario`: Template scenario to use
    -   `trap_slug`: Optional trap type override
    -   `slug`: Custom URL slug
    -   `created_at`: Timestamp
    -   `is_active`: Active status
    -   `targets`: Relationship to Target
    -   `events`: Relationship to Event

-   **`Target`**: Stores user tracking info
    -   `id`: Primary key
    -   `campaign_id`: Foreign key to Campaign
    -   `user_id`: Unique user identifier
    -   `email`: Optional email
    -   `department`: Optional department
    -   `created_at`: Timestamp

-   **`Event`**: Tracks user interactions
    -   `id`: Primary key
    -   `campaign_id`: Foreign key to Campaign
    -   `user_id`: User identifier
    -   `event_type`: `PAGE_VIEW`, `BUTTON_CLICK`, or `PAYLOAD_EXECUTED`
    -   `source_ip`: Client IP address
    -   `hostname`: Client hostname (from payload)
    -   `username`: Client username (from payload)
    -   `user_agent`: Browser user agent
    -   `platform`: Detected OS platform
    -   `timestamp`: Event timestamp

#### `app/utils.py` - Helper Functions

Contains utility functions used across the application:

*   `check_auth(username, password)`:
    *   **Purpose:** Validates admin credentials against environment variables.
    *   **Returns:** Boolean indicating if credentials are valid.

*   `authenticate()`:
    *   **Purpose:** Returns a 401 response with WWW-Authenticate header.
    *   **Returns:** Flask Response object.

*   `requires_auth(f)`:
    *   **Purpose:** Decorator for protecting routes with Basic Auth.
    *   **Usage:** `@requires_auth` on any route function.

*   `sanitize_filename(filename)`:
    *   **Purpose:** Cleans input strings to prevent directory traversal attacks while allowing slashes for nested routes.
    *   **Usage:** Applied to all user-provided slugs and filenames.
    
*   `generate_payload(user_id, server_url)`:
    *   **Purpose:** Creates the PowerShell command that is copied to the user's clipboard.
    *   **Logic:** Generates a "stager" command that downloads the full script from the payload endpoint.

*   `log_event(user_id, event_type, hostname=None, username=None)`:
    *   **Purpose:** Centralized logging function.
    *   **Logic:** Records events to the SQLite database and optionally sends a webhook notification.

*   `send_webhook(event_type, user_id, hostname=None, username=None)`:
    *   **Purpose:** Sends real-time alerts to a configured webhook (e.g., Discord, Slack).

*   `get_scenarios_and_traps()`:
    *   **Purpose:** Fetches available scenarios and traps for admin forms.
    *   **Returns:** Tuple of (scenarios list, traps list).

#### `app/cli.py` - CLI Commands

Custom Flask CLI commands:

*   `flask --app run.py init-db`:
    *   **Purpose:** Creates all database tables.

*   `flask --app run.py create-test-data`:
    *   **Purpose:** Creates a test campaign and demo user for testing.

#### `app/blueprints/` - Route Blueprints

Routes are organized into Flask Blueprints:

##### `app/blueprints/main.py` - Core Routes

-   `main_bp`: Blueprint with no URL prefix
-   **Routes:**
    -   `GET /`: Protected index page listing lures, campaigns, and traps
    -   `GET /training`: Training landing page shown after payload execution

##### `app/blueprints/admin.py` - Admin Routes

-   `admin_bp`: Blueprint with `/admin` URL prefix
-   **Routes:**
    -   `GET /admin`: Main dashboard with stats, events, and campaign list
    -   `GET /admin/campaign/<id>`: Individual campaign dashboard
    -   `GET /admin/export_csv`: Export events to CSV (Context-aware: All, Campaign-specific, or Client-specific)
    -   `POST /admin/campaign/create`: Create new campaign
    -   `POST /admin/campaign/<id>/delete`: Delete campaign
    -   `GET/POST /admin/campaign/<id>/edit`: Edit campaign
    -   `GET /admin/api/timeline`: API endpoint for timeline data aggregation
    -   `GET /admin/api/events`: API endpoint for filtered events list
    -   `GET /admin/api/stats`: API endpoint for dashboard statistics

##### `app/blueprints/lure.py` - Lure Routes

-   `lure_bp`: Blueprint with no URL prefix
-   **Routes:**
    -   `GET /s/<path:slug>`: Main handler for all phishing links
        1.  Sanitizes the slug
        2.  Serves static assets if slug matches a file
        3.  Looks up Campaign by slug or falls back to legacy mode
        4.  Creates Target if not exists
        5.  Logs PAGE_VIEW event
        6.  Renders template with payload

##### `app/blueprints/stealth.py` - Stealth Routes

Contains dynamically registered routes based on config:

*   `serve_payload(user_id)`:
    *   **Endpoint:** Configurable via `ENDPOINT_PAYLOAD` (default: `/api/v2/config/<user_id>`)
    *   **Purpose:** Serves the second-stage PowerShell script.

*   `verify_execution(user_id)`:
    *   **Endpoint:** Configurable via `ENDPOINT_VERIFY` (default: `/verify/<user_id>`)
    *   **Purpose:** Logs PAYLOAD_EXECUTED event when script calls back.

*   `track_click(user_id)`:
    *   **Endpoint:** Configurable via `ENDPOINT_TRACK` (default: `/track/click/<user_id>`)
    *   **Purpose:** Logs BUTTON_CLICK event via AJAX.

*   `track_training(user_id)`:
    *   **Endpoint:** Configurable via `ENDPOINT_TRAINING_TRACK` (default: `/track/training/<user_id>`)
    *   **Purpose:** Logs training progress events.

*   `register_stealth_routes(app)`:
    *   **Purpose:** Registers the stealth routes with the Flask app using configured endpoints.

### `cloner.py` - The Site Cloner

This utility script allows you to copy an existing website and embed a trap.

**Usage:**
```bash
python cloner.py <url> <name> --trap <trap_type>
```

**Key Functions:**

*   `clone_site(url, campaign_name, trap_type)`:
    *   **Purpose:** Downloads the HTML of the target URL and injects the trap code.
    *   **Logic:**
        1.  Fetches the page using `requests`.
        2.  Uses `BeautifulSoup` to parse the HTML.
        3.  Rewrites relative links (CSS, Images) to absolute URLs pointing to the original site.
        4.  Injects a Jinja2 `{% include %}` block before the `</body>` tag to load the selected trap.
        5.  Saves the result to `templates/campaigns/<name>/index.html`.

### `templates/components/admin_nav.html` - Admin Navigation

This component provides the floating dock navigation used across the admin interface.

**Features:**
-   **Global Navigation:** Links to Dashboard, Generator (Root), and Export.
-   **Campaign Switcher:** A popover menu to quickly switch between campaigns or access their edit screens.
-   **Context Awareness:** Buttons like "Export CSV" adapt based on the current view (e.g., exporting only the current campaign's data).
-   **Responsive Design:** Adapts to mobile and desktop views.

### `templates/base_layout.html` - Core Frontend Logic

This template provides the base structure and the critical JavaScript for the ClickFix attack.

**Key Functions (JS):**

*   `triggerClickFix()`:
    *   **Purpose:** The main function triggered by the trap button.
    *   **Logic:**
        1.  Reads the payload from a hidden input field.
        2.  Writes the payload to the system clipboard using `navigator.clipboard.writeText()`.
        3.  Sends an AJAX POST request to `/track/click/<uid>` to log the interaction.
        4.  Displays the instruction overlay (Win+R, Ctrl+V, Enter).
        5.  Starts a fake progress bar to maintain the illusion of a technical process.

### `static/js/ui.js` - UI Utilities

This file provides a modern replacement for native browser alerts and confirms.

**Key Functions:**

*   `ClickFixUI.toast(message, type, duration)`:
    *   **Purpose:** Shows a non-blocking notification toast.
    *   **Types:** `info` (default), `success`, `warning`, `error`.
    *   **Usage:** `ClickFixUI.toast('Link copied!', 'success');`

*   `ClickFixUI.confirm(message, onConfirm, onCancel)`:
    *   **Purpose:** Shows a styled modal dialog for confirmation.
    *   **Usage:** `ClickFixUI.confirm('Are you sure?', () => { deleteItem(); });`

*   `ClickFixUI.confirmSubmit(event, message)`:
    *   **Purpose:** Helper for form submission confirmation.
    *   **Usage:** `onsubmit="return ClickFixUI.confirmSubmit(event, 'Delete this?');"`

### `static/js/timeline.js` - Dashboard Timeline & Filtering

This file handles the interactive timeline chart on the Admin Dashboard, including data fetching, rendering, and filtering.

**State Management:**

The module maintains a centralized state object:
```javascript
const state = {
    startDate: null,          // Filter start date
    endDate: null,            // Filter end date
    interval: 'day',          // Aggregation interval (hour/day/week)
    eventTypes: [...],        // Active event types to display
    client: '',               // Current client filter
    campaignId: null,         // Current campaign filter
    selectedBuckets: [],      // Timeline buckets selected by user
    timelineData: null,       // Cached timeline data
    apiEndpoints: {...}       // API endpoint URLs
};
```

**Key Functions:**

*   `initDashboard(config)`:
    *   **Purpose:** Initializes the dashboard with API endpoints and default filters.
    *   **Usage:** Called on page load with configuration from the template.

*   `refreshDashboard()`:
    *   **Purpose:** Fetches fresh data from all API endpoints and updates the UI.
    *   **Usage:** Called automatically on filter changes or manually via Refresh button.

*   `renderTimeline(data)`:
    *   **Purpose:** Renders the stacked bar chart from API response data.
    *   **Logic:** Creates vertical bars with segments for each event type.

*   `toggleBucketSelection(timestamp)`:
    *   **Purpose:** Handles click on timeline bars to select/deselect time periods.
    *   **Usage:** Clicking a bar filters the events table to that time period.

**Filtering System:**

The dashboard provides two levels of filtering that work in sync:

1.  **Event Type Chips** (top filter bar):
    -   Control which event types are fetched from the API
    -   Clicking toggles the chip's active state
    -   Triggers full data refresh via `refreshDashboard()`

2.  **Legend Items** (below the chart):
    -   Control visual visibility of chart segments
    -   Synced with Event Type Chips (clicking either updates both)
    -   Provides instant visual feedback without API call

**Helper Functions:**

*   `toggleSegmentVisibility(eventType, visible)`:
    *   **Purpose:** Shows/hides specific bar segments in the chart.
    *   **Logic:** Animates height to 0px when hiding, restores original when showing.

*   `findCorrespondingChip(legendType)`:
    *   **Purpose:** Maps legend item types to their corresponding Event Type Chips.
    *   **Returns:** The chip element or null.

*   `syncLegendItem(chipType, isActive)`:
    *   **Purpose:** Keeps legend item visual state in sync with chip state.
    *   **Logic:** Adds/removes `.inactive` class and toggles segment visibility.

**Styling Notes:**

The timeline styles are in `static/css/timeline.css`:
-   `.legend-item.inactive`: Dimmed with strikethrough to indicate filtered state
-   `.bar-segment`: Smooth height/opacity transitions for toggle animations
-   `.timeline-bar.selected`: Outlined to indicate selection for table filtering

### `static/js/training.js` - Training Page Logic

Handles the interactive elements of the training page (`/training`).

**Key Features:**
-   **Scroll Tracking:** Uses `IntersectionObserver` to track which sections of the training content the user has viewed.
-   **Event Logging:** Sends `TRAINING_VIEWED` events to the backend as the user progresses through sections.
-   **Completion:** Tracks when the user acknowledges the training (e.g., clicks "I Understand").

## 5. How-To Guides

### How to Create a New Lure Template

1.  Create a new HTML file in `templates/lures/` (e.g., `vpn_error.html`).
2.  Extend `base_layout.html`:
    ```html
    {% extends "base_layout.html" %}
    {% block title %}VPN Connection Error{% endblock %}
    {% block content %}
        <!-- Your Lure Content Here -->
        <h1>VPN Error</h1>
        <button onclick="triggerClickFix()">Fix VPN</button>
    {% endblock %}
    ```
3.  The `triggerClickFix()` function (defined in `base_layout.html`) handles the clipboard copying and instruction overlay.

### How to Add a New Trap Type

1.  Create a new HTML fragment in `templates/traps/` (e.g., `new_trap.html`).
2.  This file should contain the HTML for the overlay/popup and the specific JavaScript to handle its interaction.
3.  Ensure it calls the backend tracking endpoint `/track/click/{{ user_id }}`.
4.  Update `cloner.py` to support injecting this new trap type if you want it available in the cloner.

### Available Trap Types

The following trap types are available in `templates/traps/`:

#### 1. `cloudflare` (Default)
-   **File:** `cloudflare.html`
-   **Theme:** Cloudflare "Verify you are human" CAPTCHA
-   **Trigger:** Checkbox click
-   **Use Case:** General purpose, works well on any website

#### 2. `chrome_update`
-   **File:** `chrome_update.html`
-   **Theme:** Google Chrome critical security update dialog
-   **Trigger:** "Update Chrome" button click
-   **Use Case:** Targets Chrome users, effective on tech-related sites

#### 3. `teams_error`
-   **File:** Located in `templates/lures/teams_error.html`
-   **Theme:** Microsoft Teams error message
-   **Trigger:** "Fix Issue" button click
-   **Use Case:** Corporate environments, Microsoft 365 users

#### 4. `windows_update` (NEW - Fullscreen)
-   **File:** `windows_update.html`
-   **Theme:** Windows Update screen with "Working on updates" message
-   **Trigger:** Click anywhere on initial screen → Fullscreen mode activated
-   **Use Case:** High-impact scenarios, creates maximum urgency and immersion

**Technical Details for `windows_update`:**
-   **Fullscreen API:** Uses `document.documentElement.requestFullscreen()` for immersive experience
-   **Two-Phase Design:**
    1.  Initial trigger overlay (blue screen with "Click to continue")
    2.  Main fullscreen update screen with progress indicator
-   **Progress Animation:** Circular SVG progress from 95% to 99%, then stalls
-   **Safety Features:**
    -   ESC key reveals exit button
    -   Exit button appears after 10 seconds
    -   Fullscreen exit detection shows exit button
-   **OPSEC Considerations:**
    -   Clipboard write happens BEFORE fullscreen (browser security)
    -   No external resources loaded (self-contained)
    -   Mimics authentic Windows 10/11 update styling

#### 5. `filefix` (NEW - Explorer Address Bar)
-   **File:** `filefix.html`
-   **Theme:** "File Access Verification" overlay
-   **Trigger:** "Open File Explorer" button or similar
-   **Use Case:** Simulates the "FileFix" attack where users are tricked into pasting commands into the Windows Explorer address bar.

**Technical Details for `filefix`:**
-   **Mechanism:**
    1.  User clicks the lure button.
    2.  Payload is copied to clipboard (often padded with spaces and a fake path comment).
    3.  A hidden `<input type="file">` is programmatically clicked, forcing the Windows File Explorer dialog to open.
    4.  User is instructed to paste the "path" into the address bar.
-   **Attack Vector:** Exploits the fact that the Explorer address bar can execute PowerShell commands if pasted.
-   **Safety:** The simulation uses the standard safe payload but demonstrates the UI flow of the attack.

#### 6. `missing_font` (NEW)
-   **File:** `missing_font.html`
-   **Theme:** "User Font Pack Manager" / "Roboto Slab is missing"
-   **Trigger:** "Update Font Pack" button
-   **Use Case:** Effective on design-heavy or broken-looking pages. Explains *why* the page might look wrong.

#### 7. `root_certificate` (NEW)
-   **File:** `root_certificate.html`
-   **Theme:** Browser "Connection Not Private" error
-   **Trigger:** "Install Root Certificate" button
-   **Use Case:** Simulates internal network certificate errors. Exploits the user's desire to bypass security warnings to get their work done.

### How to Use the Site Cloner

The `cloner.py` script allows you to copy an existing website and embed a trap.

```bash
python cloner.py https://example.com my_campaign_name --trap cloudflare
```

-   **URL:** The site to clone.
-   **Name:** The folder name in `templates/campaigns/`.
-   **Trap:** The type of trap to inject (`cloudflare`, `chrome_update`, `teams_error`, `windows_update`, `missing_font`, `root_certificate`, `filefix`).

### How to Customize the Payload

The PowerShell payload is generated in `app/utils.py` (`generate_payload`) and served by `app/blueprints/stealth.py` (`serve_payload`).

-   **Stage 1 (`generate_payload` in `app/utils.py`):** The initial command copied to the clipboard. It downloads the full script.
-   **Stage 2 (`serve_payload` in `app/blueprints/stealth.py`):** The full PowerShell script that runs on the victim's machine. Modify this to change the message box or behavior.

**⚠️ SAFETY WARNING:** Never add malicious code to the payload. This tool is for educational purposes only.

**⚖️ LEGAL DISCLAIMER:**
All new templates must include the "Authorized Use Only" disclaimer in the footer. This is enforced in `base_layout.html`.

## 6. Database & Logging

### Database
The application uses SQLite (`instance/training_log.db`).

**Models:**
-   `Campaign`: Stores campaign metadata.
-   `Target`: Stores user info (optional, mostly for `demo_victim`).
-   `Event`: The core log. Tracks `PAGE_VIEW`, `BUTTON_CLICK`, and `PAYLOAD_EXECUTED`.

### Application Logging
Server errors and warnings are logged to `app.log` in the root directory. Check this file for debugging issues like invalid UIDs or server errors.

To view campaign event logs, access the Admin Dashboard at `/admin` (requires Basic Auth).

## 7. Troubleshooting

-   **Clipboard API Fails:** Ensure you are accessing the site via `https://` or `localhost`. Browsers block clipboard access on insecure origins.
-   **Redirect Loops:** Check that buttons use `type="button"` to prevent form submission.
-   **Static Assets 404:** Ensure `lure_assets` route in `app.py` is correctly serving files from the campaign directory.
-   **Stealth Slug 404:** Ensure you have created a Campaign in the Admin Dashboard that maps your custom slug (e.g., `secure/login`) to a valid Scenario (e.g., `teams_error`).

## 8. Deployment & Reverse Proxies

For production deployment, it is highly recommended to use a reverse proxy like Nginx or Caddy to handle HTTPS termination and forward traffic to the Flask app.

### Option A: Caddy (Recommended)
Caddy automatically handles Let's Encrypt certificates.

```caddyfile
training.yourdomain.com {
    reverse_proxy localhost:5000
}
```

### Option B: Nginx
Standard reverse proxy configuration.

```nginx
server {
    listen 443 ssl;
    server_name training.yourdomain.com;

    ssl_certificate /etc/letsencrypt/live/training.yourdomain.com/fullchain.pem;
    ssl_certificate_key /etc/letsencrypt/live/training.yourdomain.com/privkey.pem;

    location / {
        proxy_pass http://127.0.0.1:5000;
        proxy_set_header Host $host;
        proxy_set_header X-Real-IP $remote_addr;
    }
}
```

---

*Happy Hacking & Training!*